<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Server Manager</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-left">
                <h1>ğŸ® Minecraft Server Manager</h1>
            </div>
            <div class="header-right">
                <div class="status-bar">
                    <span class="status-label">Status:</span>
                    <span id="server-status" class="status-badge status-stopped">Stopped</span>
                </div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </header>

        <div class="controls">
            <button id="start-btn" class="btn btn-success" onclick="startServer()">â–¶ Start Server</button>
            <button id="stop-btn" class="btn btn-danger" onclick="stopServer()">â¬› Stop Server</button>
            <button id="restart-btn" class="btn btn-warning" onclick="restartServer()">ğŸ”„ Restart</button>
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('console')">ğŸ“Ÿ Console</button>
            <button class="tab-btn" onclick="switchTab('files')">ğŸ“¦ Server Files</button>
            <button class="tab-btn" onclick="switchTab('worlds')">ğŸ—ºï¸ Worlds</button>
            <button class="tab-btn" onclick="switchTab('backups')">ğŸ’¾ Backups</button>
            <button class="tab-btn" onclick="switchTab('config')">âš™ï¸ Configuration</button>
            <button class="tab-btn" onclick="switchTab('users')">ğŸ‘¥ Users</button>
        </div>

        <div id="console-tab" class="tab-content active">
            <div class="server-health" id="server-health">
                <div class="health-item">
                    <span class="health-label">CPU:</span>
                    <span id="cpu-usage">0%</span>
                </div>
                <div class="health-item">
                    <span class="health-label">Memory:</span>
                    <span id="memory-usage">0 MB</span>
                </div>
                <div class="health-item">
                    <span class="health-label">Uptime:</span>
                    <span id="uptime">0s</span>
                </div>
            </div>
            <div class="console-container">
                <div id="console-output" class="console-output">Waiting for server output...</div>
            </div>
            <div class="console-input">
                <input type="text" id="command-input" placeholder="Enter server command..." onkeypress="handleCommandKey(event)">
                <button class="btn btn-primary" onclick="sendCommand()">Send Command</button>
            </div>
        </div>

        <div id="files-tab" class="tab-content">
            <div class="card">
                <h2>ğŸ“¦ Upload Server JAR</h2>
                <p>Upload a Minecraft server JAR file to upgrade versions or change server software (vanilla, Paper, Spigot, etc.)</p>
                <input type="file" id="jar-file" accept=".jar">
                <button class="btn btn-primary" onclick="uploadJar()">Upload JAR File</button>
                <div id="jar-status" class="upload-status"></div>
            </div>
        </div>

        <div id="worlds-tab" class="tab-content">
            <div class="card">
                <h2>ğŸ—ºï¸ Upload New World</h2>
                <p>Upload a zipped world folder to migrate your existing world or add a new one</p>
                <input type="file" id="world-file" accept=".zip">
                <button class="btn btn-primary" onclick="uploadWorld()">Upload World</button>
                <div id="world-status" class="upload-status"></div>
            </div>

            <div class="card">
                <h2>Available Worlds</h2>
                <div id="worlds-list">
                    <p>Loading worlds...</p>
                </div>
            </div>
        </div>

        <div id="backups-tab" class="tab-content">
            <div class="card">
                <h2>ğŸ’¾ Create Backup</h2>
                <p>Create a backup of the current active world. Old backups are automatically removed (keeping last 10).</p>
                <button class="btn btn-success" onclick="createBackup()">ğŸ”„ Create Backup Now</button>
                <div id="backup-status" class="upload-status"></div>
            </div>

            <div class="card">
                <h2>Available Backups</h2>
                <div id="backups-list">
                    <p>Loading backups...</p>
                </div>
            </div>
        </div>

        <div id="config-tab" class="tab-content">
            <div class="card">
                <h2>âš™ï¸ Server Properties</h2>
                <p>Edit server.properties configuration. Changes require a server restart to take effect.</p>
                <textarea id="properties-editor" rows="20" placeholder="Loading server properties..."></textarea>
                <button class="btn btn-success" onclick="saveProperties()">ğŸ’¾ Save Properties</button>
                <div id="properties-status" class="upload-status"></div>
            </div>
        </div>

        <div id="users-tab" class="tab-content">
            <div class="card">
                <h2>ğŸ” Change Your Password</h2>
                <p>Change the password for user: <strong id="current-username"></strong></p>
                <div class="input-group">
                    <label for="current-password">CURRENT PASSWORD</label>
                    <input type="password" id="current-password" placeholder="Enter current password">
                </div>
                <div class="input-group">
                    <label for="new-password">NEW PASSWORD</label>
                    <input type="password" id="new-password" placeholder="Enter new password (min 6 characters)">
                </div>
                <button class="btn btn-primary" onclick="changePassword()">ğŸ”‘ Change Password</button>
                <div id="password-status" class="upload-status"></div>
            </div>

            <div class="card">
                <h2>ğŸ‘¥ User Management</h2>
                <p>Add or remove users who can access the server manager</p>
                
                <div class="user-add-section">
                    <h3>Add New User</h3>
                    <div class="input-group">
                        <label for="new-username">USERNAME</label>
                        <input type="text" id="new-username" placeholder="Enter username (min 3 characters)">
                    </div>
                    <div class="input-group">
                        <label for="new-user-password">PASSWORD</label>
                        <input type="password" id="new-user-password" placeholder="Enter password (min 6 characters)">
                    </div>
                    <button class="btn btn-success" onclick="addUser()">â• Add User</button>
                    <div id="add-user-status" class="upload-status"></div>
                </div>

                <div class="users-list-section">
                    <h3>Existing Users</h3>
                    <div id="users-list">
                        <p>Loading users...</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="notification" class="notification"></div>
    </div>

    <script src="/static/js/main.js"></script>
</body>
</html>